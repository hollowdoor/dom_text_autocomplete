{"version":3,"file":"dom-text-autocomplete.min.js","sources":["../node_modules/dom-eve/dist/bundle.es.js","../src/lib/char_tree.js","../src/index.js"],"sourcesContent":["/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nvar objectAssign = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar arguments$1 = arguments;\n\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments$1[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\nvar eventsProto = objectAssign(Object.create(null), {\n    on: function on(name, cb, options){\n        this.element.addEventListener(name, cb, options);\n        this._records[name] = this._records[name] || [];\n        this._records[name].push([\n            name, cb, options\n        ]);\n        return this;\n    },\n    off: function off(name, cb, options){\n        this.element.removeEventListener(name, cb, options);\n\n        if(this._records[name] !== void 0){\n            var records = this._records[name];\n\n            for(var i=0; i<records.length; i++){\n                if(records[i][1] === cb && records[i][2] === options){\n                    records.splice(i, 1);\n                    if(i + 1 !== records.length){\n                        --i;\n                    }\n                }\n            }\n        }\n        return this;\n    },\n    dispatch: function dispatch(event){\n        this.element.dispatchEvent(event);\n        return this;\n    },\n    clear: function clear(){\n        var this$1 = this;\n\n        for(var name in this$1._records){\n            var records = this$1._records[name];\n            records.forEach(function (record){\n                (ref = this$1).off.apply(ref, record);\n                var ref;\n            });\n        }\n        return this;\n    }\n});\n\nfunction events(element, tracker){\n    if ( tracker === void 0 ) tracker = null;\n\n    var eve = Object.create(eventsProto);\n    eve._records = Object.create(null);\n    if(typeof element === 'string'){\n        eve.element = document.querySelector(element);\n    }else{\n        eve.element = element;\n    }    \n\n    if(tracker){\n        tracker.list.push(eve);\n    }\n\n    return eve;\n}\n\nevents.track = function track(){\n    return {\n        list: [],\n        clear: function clear(){\n            this.list.forEach(function (item){\n                item.clear();\n            });\n        }\n    };\n};\n\nexport default events;\n//# sourceMappingURL=bundle.es.js.map\n","export default class CharTree {\n    constructor(){\n        this.tree = {branches: {}, items: []};\n    }\n    empty(){\n        this.tree = {branches: {}, items: []};\n    }\n    push(...datas){\n        datas.forEach(data=>{\n\n            let next = this.tree;\n            let list = data.split('');\n\n            list.forEach(ch=>{\n                let key = ch.toLowerCase();\n                next = (next.branches[key] = next.branches[key] || Object.create(null));\n                next.branches = next.branches || Object.create(null);\n                next.items = next.items || [];\n                next.items.push(data);\n                next.value = ch;\n            });\n\n            next.leaf = true;\n        });\n    }\n    remove(...datas){\n        datas.forEach(data=>{\n            let next = this.tree, last;\n            let list = data.split('');\n\n            for(let i=0; i<list.length; i++){\n                let char = list[i];\n                let key = char.toLowerCase();\n                let index;\n\n                last = next;\n                next = next.branches[key];\n\n                if(next === void 0) break;\n\n                if((index = next.items.indexOf(data.value)) !== -1){\n                    next.items.splice(index, 1);\n                    if(!next.items.length){\n                        delete last.branches[key];\n                    }else{\n                        next = next.branches[key];\n                    }\n                }\n\n            }\n        });\n    }\n    match(value){\n        let list = value.split('').map(v=>v.toLowerCase());\n\n        let next = this.tree,\n            len = list.length + 1,\n            last,\n            string = '';\n\n        if(!list.length) return {tree: null, string, value};\n\n        for(let i=0; i<len; i++){\n            last = next;\n            next = next.branches[list[i]];\n            if(!next){\n                if(list[i] !== void 0) last = null;\n                break;\n            }else{\n                string += next.value;\n            }\n        }\n\n        return {tree: last, string, value};\n    }\n    findAll(value){\n        let {tree} = this.match(value);\n        if(!tree) return [];\n        return [].concat(tree.items);\n    }\n    nextPhrase(value, sep){\n\n        let {tree, string} = this.match(value),\n            result = string;\n\n        sep = /[ ]+/;\n\n        const iter = (next)=>{\n\n            if(next.leaf){\n                return result;\n            }\n\n            let keys = Object.keys(next.branches);\n            for(let key in next.branches){\n                if(sep.test(key)){\n                    return result;\n                }\n                result += next.branches[key].value;\n                return iter(next.branches[key])\n\n            }\n        };\n\n        return iter(tree);\n    }\n}\n\nfunction lower(item){\n    return item.toLowerCase();\n}\n","import events from 'dom-eve';\nimport CharTree from './lib/char_tree.js';\n\nclass DOMTextAutocomplete {\n    constructor(input, {\n        read = null,\n        allowEntry = null,\n        entry = null,\n        render = null\n    }){\n        this.input = input;\n        this.searchable = new CharTree();\n        this._render = render;\n\n        const tracker = events.track();\n        events(input, tracker)\n        .on('keyup', event=>{\n            if(allowEntry){\n                if(!allowEntry(event)){\n                    return;\n                }\n            }\n            if(read){\n                Promise.resolve(read.call(this, event))\n                .then(()=>{\n                    entry.call(this, event);\n                });\n                return;\n            }\n            entry.call(this, event);\n        });\n    }\n    fill(parent){\n        let value = this.input.value;\n        let found = this.searchable.findAll(value);\n        parent.innerHTML = '';\n        found.forEach(data=>{\n            let html = this._render(data);\n            parent.insertAdjacentHTML(\n                'beforeend',\n                html\n            );\n        });\n        return !!found.length;\n    }\n    query(element, selector){\n        /*let el = element.querySelector(selector);\n        if(el){\n            this.input.value = el.dataset[];\n        }*/\n    }\n    push(...values){\n        values.forEach(value=>{\n            this.searchable.push(value);\n        });\n        return this;\n    }\n    empty(){\n        this.searchable.empty();\n        return this;\n    }\n}\n\nexport default function autoComplete(input, options){\n    return new DOMTextAutocomplete(input, options);\n}\n"],"names":["toObject","val","undefined","TypeError","Object","events","element","tracker","eve","create","eventsProto","_records","document","querySelector","list","push","getOwnPropertySymbols","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","assign","test1","String","getOwnPropertyNames","test2","i","fromCharCode","map","n","join","test3","split","forEach","letter","keys","err","shouldUseNative","target","source","from","symbols","arguments$1","arguments","to","s","length","key","call","on","name","cb","options","this","addEventListener","off","removeEventListener","records","splice","dispatch","event","dispatchEvent","clear","this$1","record","ref","apply","track","item","CharTree","tree","branches","items","empty","datas","data","next","ch","toLowerCase","value","leaf","remove","let","last","index","indexOf","match","v","len","string","findAll","concat","nextPhrase","sep","result","iter","test","DOMTextAutocomplete","input","searchable","_render","render","allowEntry","read","Promise","resolve","then","entry","fill","parent","found","innerHTML","html","insertAdjacentHTML","query","selector","values"],"mappings":"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"}